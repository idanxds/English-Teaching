<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>אתר למידה באנגלית</title>

    <!-- PWA and Mobile Tags -->
    <meta name="theme-color" content="#2c3e50"/>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">

    <!-- SUPABASE SCRIPT -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Links to the CSS file -->
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- === NEW: AUTH POPUP MODAL (Overlay) === -->
    <!-- This sits ON TOP of the website until logged in -->
    <div id="auth-modal" class="auth-overlay hidden">
        <div class="auth-box">
            <h1>ברוכים הבאים</h1>
            <p>אנא התחבר כדי לגשת לתכני האתר</p>
            <p id="auth-status-msg" style="margin-bottom: 20px; min-height: 20px;"></p>
            
            <input type="email" id="auth-email" placeholder="אימייל" class="auth-input">
            <input type="password" id="auth-password" placeholder="סיסמא" class="auth-input">
            
            <button id="btn-signin-email" class="action-button full-width">התחבר</button>
            <button id="btn-signup-email" class="action-button secondary full-width">הרשמה חדשה</button>
            
            <div class="separator">או</div>
            
            <button id="btn-signin-google" class="action-button google-btn full-width">
                התחבר עם Google
            </button>
        </div>
    </div>

    <!-- === MAIN WEBSITE WRAPPER === -->
    <!-- This gets BLURRED when not logged in -->
    <div id="main-wrapper">
        
        <!-- 1. Left Sidebar for Translation -->
        <aside class="translate-sidebar">
            <div class="word-tool-container">
                <h2>כלי מילים אוניברסלי</h2>
                <p>הקלד מילה (בכל שפה) לקבלת תרגומים והגדרות:</p>
                <div class="word-tool-controls">
                    <input type="text" id="word-input-auto" placeholder="הקלד מילה..." dir="rtl">
                    <button id="word-tool-btn" class="action-button small">חפש</button>
                </div>
                <div id="word-tool-results"></div>
            </div>
        </aside>
        
        <!-- 2. Main Content Area -->
        <div class="main-content">
            <nav class="main-nav">
                <div class="nav-links">
                    <button class="nav-button" data-target="tutorial-page">הדרכה לאפליקציה</button>
                    <button class="nav-button" data-target="presentations-page">מצגות</button>
                    <button class="nav-button" data-target="youtube-page">סרטוני YouTube</button>
                    <button class="nav-button" data-target="podcast-page">פודקאסט</button>
                    <!-- LOGOUT BUTTON -->
                    <button id="nav-logout-btn" class="nav-button hidden" style="color: #e74c3c;">התנתק</button>
                </div>
                <div class="nav-brand">
                    <button class="nav-button" data-target="home-page">עמוד הבית</button>
                </div>
                <!-- Mobile-only Menu Button -->
                <button id="mobile-menu-btn" class="mobile-menu-button">
                    <span></span><span></span><span></span>
                </button>
            </nav>

            <div id="app">
                <!-- Home Page -->
                <section id="home-page" class="page">
                    <div class="home-container">
                        <h1>ברוכים הבאים לאתר הלמידה</h1>
                        <p>בחר קטגוריה מהתפריט או הכנס למשימות</p>
                        <button id="go-to-hub-btn" class="action-button large" onclick="document.querySelector('[data-target=\'assignment-hub-page\']').click()">למשימות הלמידה</button>
                    </div>
                </section>

                <!-- ADMIN PAGE (Hidden, only for specific emails) -->
                <section id="admin-page" class="page hidden">
                    <button class="back-button" onclick="location.reload()">יציאה ממצב מנהל</button>
                    <h1>לוח בקרה למנהלים (Admin)</h1>
                    <div class="admin-container">
                        <div class="admin-stats">
                            <div class="stat-box">
                                <h3>משתמשים רשומים</h3>
                                <p id="admin-user-count">--</p>
                            </div>
                            <div class="stat-box">
                                <h3>משימות שהושלמו</h3>
                                <p id="admin-total-tasks">--</p>
                            </div>
                        </div>

                        <h2>התקדמות תלמידים</h2>
                        <p style="color: #e74c3c; font-size: 0.9em;">* כרגע מוצגים נתוני דוגמא. כדי לראות נתוני אמת, יש לחבר את המשימות למסד הנתונים של Supabase.</p>
                        
                        <div class="table-responsive">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>שם / אימייל</th>
                                        <th>התחברות אחרונה</th>
                                        <th>משימות שהושלמו</th>
                                        <th>סטטוס</th>
                                    </tr>
                                </thead>
                                <tbody id="admin-users-table">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Assignment Hub Page -->
                <section id="assignment-hub-page" class="page hidden">
                    <button class="back-button" data-target="home-page">חזרה</button>
                    <h1>משימות למידה</h1>
                    <div class="assignments-grid">
                        <button class="assignment-box" data-assignment="abc">
                            <h3>ה-ABC האנגלי</h3>
                            <p>לימוד אותיות, שמע ומקרים מיוחדים.</p>
                        </button>
                        <button class="assignment-box" data-assignment="verbs">
                            <h3>פעלים (Verbs)</h3>
                            <p>לימוד פעלים, תרגול ובניית משפטים.</p>
                        </button>
                        <button class="assignment-box" data-assignment="future-simple">
                            <h3>עתיד פשוט (Future Simple)</h3>
                            <p>לימוד ותרגול שימוש ב-will ו-would.</p>
                        </button>
                        <button class="assignment-box" data-assignment="simple-past">
                            <h3>עבר פשוט (Simple Past)</h3>
                            <p>לימוד חוקים, פעלים רגילים ויוצאי דופן.</p>
                        </button>
                        <button class="assignment-box" data-assignment="reading">
                            <h3>קריאה (Reading)</h3>
                            <p>תרגול קטעי קריאה ברמות שונות.</p>
                        </button>
                        <button class="assignment-box" data-assignment="grammar">
                            <h3>דקדוק (Grammar)</h3>
                            <p>לימוד ותרגול WH, Present Simple ועוד.</p>
                        </button>
                        <button class="assignment-box" data-assignment="writing">
                            <h3>כתיבה (Writing)</h3>
                            <p>למדו לתאר, להשוות ולכתוב פסקאות.</p>
                        </button>
                        <button class="assignment-box" data-assignment="speaking">
                            <h3>דיבור (Speaking)</h3>
                            <p>תרגול זיהוי שגיאות וקריאה נכונה.</p>
                        </button>
                        <button class="assignment-box" data-assignment="adjectives">
                            <h3>שמות תואר (Adjectives)</h3>
                            <p>תרגול שמות תואר ותואר הפועל.</p>
                        </button>
                    </div>
                </section>

                <!-- Podcast Page -->
                <section id="podcast-page" class="page hidden">
                    <button class="back-button" data-target="home-page">חזרה</button>
                    <h1>פודקאסטים</h1>
                    <div class="podcast-grid">
                        <div class="podcast-player">
                            <h3>פודקאסט 1</h3>
                            <audio controls src="https://archive.org/download/full-podcast_202511/Full%20Podcast.mp3">דפדפן זה אינו תומך באודיו.</audio>
                        </div>
                        <div class="podcast-player"><h3>פודקאסט 2</h3><audio controls src="audio1.opus"></audio></div>
                        <div class="podcast-player"><h3>פודקאסט 3</h3><audio controls src="audio2.opus"></audio></div>
                    </div>
                </section>

                <!-- YouTube Page -->
                <section id="youtube-page" class="page hidden">
                    <button class="back-button" data-target="home-page">חזרה</button>
                    <h1>סרטוני YouTube</h1>
                    <div class="youtube-grid">
                        <!-- JS fills this -->
                    </div>
                </section>

                <!-- Video Player Page -->
                <section id="video-player-page" class="page hidden">
                    <button class="back-button" data-target="youtube-page">חזרה לסרטונים</button>
                    <h1 id="video-player-title"></h1>
                    <div class="video-container">
                        <iframe id="youtube-iframe" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                </section>

                <!-- Assignment Task Page (Dynamic) -->
                <section id="task-page" class="page hidden">
                    <button class="back-button" data-target="assignment-hub-page">חזרה למשימות</button>
                    <div id="task-content"></div>
                </section>
                
                <!-- Quiz Page (Dynamic) -->
                <section id="quiz-page" class="page hidden">
                    <div id="quiz-container">
                        <div id="quiz-progress"></div>
                        <div id="quiz-question" class="ltr"></div>
                        <div id="quiz-options"></div>
                        <div id="quiz-feedback"></div>
                        <button id="quiz-next-btn" class="action-button hidden">המשך</button>
                    </div>
                </section>

                <!-- ABC Audio Page -->
                <section id="abc-audio-page" class="page hidden">
                    <button class="back-button" data-target="assignment-hub-page">חזרה למשימות</button>
                    <h1>האותיות</h1>
                    <div id="abc-audio-content" class="text-passage">
                        <p>(שימוש באוזניות או קול חיצוני הוא נדרש בשביל החלק הזה.)</p>
                        <div id="audio-players-container" class="audio-players-container"></div>
                        <button id="abc-audio-continue" class="action-button hidden" data-assignment="abc" data-quiz="abcQuiz">המשך לתרגול</button>
                    </div>
                </section>
                
                <!-- Sentence Builder Page -->
                <section id="sentence-builder-page" class="page hidden">
                    <button class="back-button" data-target="assignment-hub-page">חזרה למשימות</button>
                    <h1>בניית משפט</h1>
                    <div class="text-passage">
                        <div id="built-sentence-container"></div>
                        <div id="word-options" class="quiz-options"></div>
                        <p id="sentence-feedback" class="quiz-feedback"></p>
                    </div>
                </section>

                <!-- Presentations Page -->
                <section id="presentations-page" class="page hidden">
                    <button class="back-button" data-target="home-page">חזרה</button>
                    <h1>מצגות</h1>
                    <div class="presentation-grid"></div>
                </section>

                <!-- Presentation Viewer Page -->
                <section id="presentation-viewer-page" class="page hidden">
                    <button class="back-button" data-target="presentations-page">חזרה למצגות</button>
                    <h1 id="presentation-viewer-title"></h1>
                    <div class="presentation-container">
                        <iframe id="presentation-iframe" src="" frameborder="0" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
                    </div>
                </section>

                <!-- Tutorial Page -->
                <section id="tutorial-page" class="page hidden">
                    <button class="back-button" data-target="home-page">חזרה</button>
                    <h1>הדרכה להתקנת האפליקציה</h1>
                    <div class="tutorial-container">
                        <div class="tutorial-step">
                            <p><strong>שלב 1:</strong> בדפדפן כרום, לחץ על כפתור שלוש הנקודות בפינה.</p>
                            <img src="https://i.ibb.co/bK4p0m2/Screenshot-20251111-185545-Chrome.jpg" alt="שלב 1">
                        </div>
                        <div class="tutorial-step">
                            <p><strong>שלב 2:</strong> בתפריט שנפתח, בחר באפשרות "הוספה למסך הבית" או "התקנת אפליקציה".</p>
                            <img src="https://i.ibb.co/3sN0m3t/Screenshot-20251111-185551-Chrome.jpg" alt="שלב 2: הוספה למסך הבית">
                        </div>
                    </div>
                </section>

            </div> <!-- /#app -->
        </div> <!-- /.main-content -->
    </div> <!-- /#main-wrapper -->

    <!-- Scripts -->
    <script src="script.js"></script>
    <!-- Tawk.to -->
    <script type="text/javascript">
    var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
    (function(){
    var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
    s1.async=true;
    s1.src='https://embed.tawk.to/6912e746f9fa8f19671f5407/default';
    s1.charset='UTF-8';
    s1.setAttribute('crossorigin','*');
    s0.parentNode.insertBefore(s1,s0);
    })();
    </script>
</body>
</html>
